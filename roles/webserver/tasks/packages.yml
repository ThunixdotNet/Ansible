# Install apache and accoutrements www, irrespective of what role they might have
---
- name: Add apt key for tor project repo
  apt_key:
    url: https://deb.torproject.org/torproject.org/A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89.asc
    state: present

- name: Add tor project repo
  apt_repository:
    repo: 'deb https://deb.torproject.org/torproject.org buster main'
    state: present
    filename: tor
    update_cache: yes

- name: Add tor project repo
  apt_repository:
    repo: 'deb-src https://deb.torproject.org/torproject.org buster main'
    state: present
    filename: torsrc
    update_cache: yes

- name: Install packages for webserver
  apt:
    name: "{{ packages }}"
    state: present
    update_cache: yes
  vars:
    packages:
      - apache2
      - createrepo
      - dpkg-dev
      - gophernicus
      - libapache2-mod-php7.0
      - mariadb-client
      - mariadb-server
      - php-imagick
      - php-mbstring
      - php-memcache
      - php-pear
      - php7.0
      - php7.0-curl
      - php7.0-gd
      - php7.0-imap
      - php7.0-intl
      - php7.0-mcrypt
      - php7.0-mysql
      - php7.0-pspell
      - php7.0-recode
      - php7.0-sqlite3
      - php7.0-tidy
      - php7.0-xmlrpc
      - php7.0-xsl
      - shellinabox
      - tor
      - torsocks
      - yum-utils
