# Configure minecraft server
---
- name: Create home dirs for minecraft
  file:
    path: /var/lib/minecraft
    state: directory
    owner: minecraft
    group: minecraft
    mode: 0770

- name: Install minecraft target
  copy:
    dest: /etc/systemd/system/minecraft.service
    content: |
      [Install]
      WantedBy=multi-user.target

      [Unit]
      Description=Minecraft Game Server
      After=network-online.target

      [Service]
      ExecStart=/var/lib/minecraft/paper/start.sh
      ExecReload=/bin/kill -HUP $MAINPID
      User=minecraft

      [Install]
      WantedBy=multi-user.target

- name: Install start.sh
  copy:
    src: ../files/var/lib/minecraft/paper/start.sh
    dest: /var/lib/minecraft/paper/start.sh
    owner: minecraft
    group: root
    mode: 0770

- name: Install minecraft ops list
  copy:
    src: ../files/var/lib/minecraft/paper/ops.json
    dest: /var/lib/minecraft/paper/ops.json
    owner: minecraft
    group: minecraft
    mode: 0660
